// test.flx
// Copyright (c) 2014 - The Foreseeable Future, zhiayang@gmail.com
// Licensed under the Apache License Version 2.0.

import Foundation

var m = 40

struct Bar
{
	var norf: Int = 1600
	var yorg: Int = 5000
	var goop: Int = 6810

	static func unNest() -> Int
	{
		return 581
	}

	func shit() -> Int
	{
		return self.goop - self.norf
	}

	struct Nested
	{
		var g: Int = 500

		struct Nest2
		{
			var m: Int = 230
			func doShit() -> Int
			{
				println("doing shit...")
				return 47
			}

			static func staticFunc() -> Int
			{
				println("Doing some shit of a static nature...")
				return 74
			}
		}
	}

	init()
	{
		self.norf = 1000
		self.goop = 1500
	}

	init(q: Int, a: Int)
	{
		self.qux = q
		self.aaa = a
	}
}

extension Bar
{
	var qux: Int = 500
	var aaa: Int = 1000

	// init()
	// {
	// 	self.init(100, 300)
	// }

	func fwoosh()
	{
		println("Fwoosh! The joke goes over your head.");
	}

	var poog: Int
	{
		get
		{
			return 500
		}
		set(fag)
		{
			self.norf = fag / 4
		}
	}
}

func testing() -> Int
{
	defer println("this comes last")
	defer println("this comes next")
	defer println("this comes first")
	defer i += 58

	var i = 27

	return i
}

func main(argc: Int32, argv: Int8**) -> Int
{
	var k: Bar.Nested
	var j = alloc[4] Bar
	// j[1].norf = 100

	printf("goop: %d, norf: %d\n", j[1].goop, j[1].norf)
	printf("%d, %d, %d, %d\n", k.g, Bar.unNest(), j[1].goop - j[1].norf, Bar.Nested.Nest2.staticFunc())

	printf("testing: %d\n", testing())
	return 0
}











