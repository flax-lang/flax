language: cpp
compiler: clang
dist: trusty
sudo: false

addons:
    apt:
        sources:
        - llvm-toolchain-trusty-$LLVM_VERSION
        - ubuntu-toolchain-r-test
            
        packages:
        - g++-$GCC_VERSION
        - llvm-$LLVM_VERSION
        - llvm-$LLVM_VERSION-dev
        - libllvm$LLVM_VERSION
        - libmpfr-dev
        - libmpfr4

script:
    - CXX=g++-$GCC_VERSION CC=gcc-$GCC_VERSION make ci

notifications:
    email: false

after_success:
    - zip -r linux-x64 build/sysroot

deploy:
    provider: releases
    api-key: ${GITHUB_OAUTH_TOKEN}
    file: linux-x64.zip
    skip-cleanup: true
    on:
        all_branches: true
        tags: true
